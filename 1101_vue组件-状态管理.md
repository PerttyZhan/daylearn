#   **关于前端组件化，状态管理规范化的思考**

通常处理共享状态有三种方式：  

    1. 状态提升，我们需要把子组件共享的状态，提示到容器组件进行管理，并有容器组件下发到子组件
    2. 状态管理redux, vuex
    3. 事件机制，子组件改变共享的状态，通过事件管理模块emit分开出去，需要同步更改状态的子组件通过on接收更改事件

引入状态管理就真的能解决所有的问题吗？ 

    1. 组件哪些状态需要提取到状态管理
    2. 如何皮面滥用全局状态导致项目混乱
    3. 容器组件，展示组件如何划分
    4. 多人协作开发组件规范，风格不统一，组件间共享状态双向修改股则不统一

##  **想法**  

![状态管理图](https://user-gold-cdn.xitu.io/2018/10/23/1669ff1e8840f8bd?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)    

**容器内组件: 主要是获取，更新，提交，删除内含展示组件状态数据，不包含任何virtual domd的修改或者组合，也不包含组件的样式。** 

**展示型组件:  展示型组件主要表现为组件时怎样渲染的，包含了virtual dom的修改或者组合，也包含组件的样式，同进不依赖任何形式的store。一般可以写成无状态函数，但实际上由于很多展示型组件里依然存在生存周期方法，所有不一定都是无状态的组件**    

说明： 

    1. 项目初期版本，只有一个容器组件A，容器A包含三个展示组件A1，A2，A3，所有共享状态都有容器A管理
    2. 随着版本迭代，容器组件A分裂出连个新模块容器组件B，C
    3. 容器组件B，C分别包含展示组件B1，B2，C1, C2，且B，C之间存在共享状态
    4. 容器组件共享状态数据，统一由状态管理store管理

规范： 

    1. 展示组件必须在容器组件中使用，除了独有的状态，其他共享状态统一由容器组件管理
    2. 展示组件涉及修改共享状态的操作，例如点击事件，需要把点击事件通过无状态的回调函数抛到容器组件，由容器组件统一做状态获取，更新，提交，删除等等操作
    3. 父子容器组件共享状态，子容器只能读取父容器组件共享状态，不能修改（例如子容器不能通过无状态回调函数抛到父容器，由父容器更新状态），保证单项数据流
    4. 子容器修改父容器或者修改非父子共享状态唯一途径，通过状态管理store统一修改
    5. 由于容器间共享状态不能双向修改，所有状态管理store保存大量的共享状态数据，需要通过系统块，容器组件名分层注册需要状态共享的容器组件state